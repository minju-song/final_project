<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.holoyolo.app.pointHistory.mapper.PointHistoryMapper">
	<select id="pointBalance" resultType="int">
		SELECT    
		    NVL(SUM(NVL(PA1, 0)), 0) - NVL(SUM(NVL(PA2, 0)), 0) AS 잔액
		FROM
		    (
		    SELECT point_type, price, member_id
		    FROM point_history
		    WHERE member_id = 'hsg04067@naver.com'
		    )
		PIVOT
		    (
		    SUM(price) FOR point_type IN ('PA1' AS PA1, 'PA2' AS PA2)
		    )
	</select>
</mapper>